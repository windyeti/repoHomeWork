{"version":3,"names":[],"mappings":"","sources":["main.js"],"sourcesContent":["function Container() {\n\tthis.id = '';\n\tthis.className = '';\n\tthis.htmlCode = '';\n}\nContainer.prototype.render = function() {\n\treturn this.htmlCode\n}\nfunction Basket() {\n\tContainer.call(this);\n\n\tthis.id = 'basket';\n\tthis.countGoods = 0;\n\tthis.amount = 0;\n\tthis.goodItems = [];\n}\nBasket.prototype = Object.create(Container.prototype);\nBasket.prototype.constructor = Basket;\nBasket.prototype.render = function(wrapper) {\n\tthis.$divBasket = $('<div>').attr({\n\t\t\tid: this.id\n\t\t}).text('Корзина');\n\n\tthis.$divBasket.appendTo(wrapper);\n\n\tthis.getGoodItems();\n}\nBasket.prototype.getGoodItems = function() {\n\t$.ajax({\n\t\turl : '/basket.goods.json',\n\t\tdataType : 'json',\n\t\tcontext : this,\n\t\tsuccess : function(data) {\n\t\t\tif(data.result == 1) {\n\t\t\t\tthis.countGoods = data.basket.length;\n\t\t\t\tthis.amount = parseInt(data.amount);\n\t\t\t\tthis.goodItems = data.basket;\n\n\t\t\t\tthis.$divData = $('<div>').attr({'class' : 'div-data'});\n\t\t\t\tthis.$divData.append( $('<p>').attr({'class' : 'count-good'}).text('Всего товаров в корзине: ' + this.countGoods) )\n\t\t\t\tthis.$divData.append( $('<p>').attr({'class' : 'amount'}).text('На сумму: ' + this.amount) )\n\t\t\t\tthis.$divData.appendTo(this.$divBasket);\n\n\t\t\t} else {\n\t\t\t\tconsole.log('что-то на сервере не так');\n\t\t\t}\n\t\t},\n\t\terror : function(err) {\n\t\t\tconsole.log(err.message)\n\t\t}\n\t});\n}\nBasket.prototype.add = function(idGood, quantity, price) {\n\tthis.countGoods += quantity;\n\tthis.amount += +price;\n\tthis.goodItems.push({\n\t\tid_product : idGood,\n\t\tprice : price\n\t});\n\tthis.refresh();\n}\nBasket.prototype.refresh = function() {\n\tthis.$divData.empty();\n\tthis.$divData.append( $('<p>').attr({'class' : 'count-good'}).text('Всего товаров в корзине: ' + this.countGoods) )\n\tthis.$divData.append( $('<p>').attr({'class' : 'amount'}).text('На сумму: ' + this.amount) )\n\tthis.$divData.appendTo(this.$divBasket);\n}\nfunction Review() {\n\tContainer.call(this);\n\tthis.id = '';\n\tthis.goodReviews = [];\n\tthis.resultSearch = {};\n}\nReview.prototype = Object.create(Container.prototype);\nReview.prototype.constructor = Review;\n\nReview.prototype.render = function(idProduct, objSelected) {\n\t// console.log(objSelected.text());\n\tthis.$goodSelected = objSelected;\n\t// console.log(this.$goodSelected.text())\n\t// this.$divReview = $('<div>').attr({'class' : 'review'});\n\t\n\tthis.getReviews(idProduct);\n\tvar proba = $('#review').text();\n\tconsole.log(proba);\n};\n\nReview.prototype.getReviews = function(idProduct) {\n\tfunction view(value) {\n\t\tthis.resultSearch = value;\n\t}\n\tvar resultSearch = 0;\n\t$.ajax({\n\t\turl : 'review.good.json',\n\t\tdataType : 'json',\n\t\tcontext : this,\n\t\tsuccess : function(data) {\n\t\t\tvar dataDiv = $('<div>', {'id' : 'review'})\n\t\t\tif(data.result == 1) {\t\t\t\t\n\t\t\t\t$(data.goods).each(function(inx, value) {\n\t\t\t\t\tif(value.id_product == idProduct) {\n\t\t\t\t\t\t// view(value);\n\t\t\t\t\t\t// $.each(value.reviews, function(inx, value) {\n\t\t\t\t\t\t// \tvar $divSubmit = $('<div>').attr('class', 'submit').text(value.submit);\n\t\t\t\t\t\t// \t$divSubmit.append( $('<span>').attr('class', 'plus').text('--одобрить--') );\n\t\t\t\t\t\t// \tvar $divContainer = $('<div>').attr('class','reviewContainer');\n\t\t\t\t\t\t// \t$divContainer.append( $divSubmit );\n\t\t\t\t\t\t// \t$divContainer.append( $('<div>').attr('class', 'textReview').text(value.text) )\n\t\t\t\t\t\t// })\n\t\t\t\t\t\t\n\t\t\t\t\t\t// resultSearch = $divContainer;\n\t\t\t\t\t\t// console.log(resultSearch)\n\t\t\t\t\t\tdataDiv.text('проба')\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\terror : function() {\n\t\t}\n\t});\n};"],"file":"main.js"}